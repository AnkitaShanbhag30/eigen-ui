{% extends "base.html.j2" %}

{% block content %}
  <!-- Hero Section - Dynamic based on user inputs and brand data -->
  {% if hero_url or custom_data.hero_url %}
    <section class="hero">
      <img src="{{ hero_url or custom_data.hero_url }}" alt="Hero image for {{ title or outline.headline or brand.name }}"/>
      <div class="hero-overlay"></div>
      <div class="hero-content">
        <h1 class="font-bold">{{ title or outline.headline or brand.name }}</h1>
        {% if subtitle or outline.subhead %}
          <p>{{ subtitle or outline.subhead }}</p>
        {% endif %}
        {% if cta or outline.cta %}
          <a href="#" class="btn btn-primary">{{ cta or outline.cta }}</a>
        {% endif %}
      </div>
    </section>
  {% else %}
    <!-- Text-only hero when no image -->
    <section class="text-center mb-10">
      <h1 class="text-5xl font-bold text-brand-primary mb-4">
        {{ title or outline.headline or brand.name }}
      </h1>
      {% if subtitle or outline.subhead %}
        <p class="text-xl text-brand-muted mb-6 max-w-2xl mx-auto">
          {{ subtitle or outline.subhead }}
        </p>
      {% endif %}
      {% if cta or outline.cta %}
        <a href="#" class="btn btn-primary text-lg px-8 py-4">{{ cta or outline.cta }}</a>
      {% endif %}
    </section>
  {% endif %}

  <!-- Brand Overview Section - Dynamic from brand data -->
  {% if brand.description or brand.tagline or brand.keywords %}
    <section class="section">
      <h2 class="section-title">About {{ brand.name }}</h2>
      <div class="card">
        {% if brand.description %}
          <p class="mb-4">{{ brand.description }}</p>
        {% endif %}
        {% if brand.tagline %}
          <p class="text-lg font-medium text-brand-secondary mb-4">{{ brand.tagline }}</p>
        {% endif %}
        {% if brand.keywords %}
          <div class="flex gap-2 flex-wrap">
            {% for keyword in brand.keywords[:8] %}
              <span class="px-3 py-1 bg-brand-accent text-white text-sm rounded-full font-medium">
                {{ keyword }}
              </span>
            {% endfor %}
          </div>
        {% endif %}
      </div>
    </section>
  {% endif %}

  <!-- Dynamic Content Sections - From user inputs or generated outline -->
  {% if outline and outline.sections %}
    {% for outline_section in outline.sections %}
      <section class="section">
        <h2 class="section-title">{{ outline_section.title }}</h2>
        
        <!-- Use brand's UI patterns to determine layout -->
        {% set section_layout = outline_section.layout_style or 'default' %}
        {% set content_type = outline_section.content_type or 'general' %}
        
        {% if section_layout == 'card' or content_type in ['solution', 'benefits'] %}
          <!-- Card-based layout for solutions and benefits -->
          <div class="card">
            {% if outline_section.bullets and outline_section.bullets|length > 0 %}
              <ul class="space-y-2">
                {% for bullet in outline_section.bullets %}
                  <li class="flex items-start gap-3">
                    <span class="w-2 h-2 bg-brand-accent rounded-full mt-2 flex-shrink-0"></span>
                    <span>{{ bullet }}</span>
                  </li>
                {% endfor %}
              </ul>
            {% endif %}
            {% if outline_section.content %}
              <p>{{ outline_section.content }}</p>
            {% endif %}
          </div>
        {% elif section_layout == 'grid' or content_type in ['features', 'metrics'] %}
          <!-- Grid layout for features and metrics -->
          {% if outline_section.bullets and outline_section.bullets|length > 0 %}
            <div class="grid grid-cols-{{ outline_section.bullets|length if outline_section.bullets|length <= 4 else 4 }} gap-6">
              {% for bullet in outline_section.bullets %}
                <div class="card text-center">
                  <div class="text-3xl font-bold text-brand-primary mb-2">{{ bullet }}</div>
                  <div class="text-brand-muted text-sm">Feature {{ loop.index }}</div>
                </div>
              {% endfor %}
            </div>
          {% elif outline_section.items and outline_section.items|length > 0 %}
            <!-- Grid layout for custom items -->
            <div class="grid grid-cols-{{ outline_section.columns or 3 }} gap-6">
              {% for item in outline_section.items %}
                <div class="card text-center">
                  {% if item.icon %}
                    <div class="text-4xl mb-4">{{ item.icon }}</div>
                  {% endif %}
                  {% if item.title %}
                    <h3 class="text-xl font-semibold text-brand-primary mb-2">{{ item.title }}</h3>
                  {% endif %}
                  {% if item.value %}
                    <div class="text-3xl font-bold text-brand-secondary mb-2">{{ item.value }}</div>
                  {% endif %}
                  {% if item.description %}
                    <p class="text-brand-muted">{{ item.description }}</p>
                  {% endif %}
                </div>
              {% endfor %}
            </div>
          {% endif %}
        {% elif section_layout == 'list' or content_type in ['differentiation', 'steps'] %}
          <!-- List layout for differentiation and steps -->
          {% if outline_section.bullets and outline_section.bullets|length > 0 %}
            <div class="space-y-4">
              {% for bullet in outline_section.bullets %}
                <div class="flex items-start gap-4 p-4 bg-brand-muted bg-opacity-10 rounded-lg">
                  <div class="w-6 h-6 bg-brand-accent text-white rounded-full flex items-center justify-center text-sm font-bold">
                    {{ loop.index }}
                  </div>
                  <div>{{ bullet }}</div>
                </div>
              {% endfor %}
            </div>
          {% endif %}
        {% else %}
          <!-- Default layout -->
          {% if outline_section.bullets and outline_section.bullets|length > 0 %}
            <div class="card">
              <ul class="space-y-2">
                {% for bullet in outline_section.bullets %}
                  <li class="flex items-start gap-3">
                    <span class="w-2 h-2 bg-brand-accent rounded-full mt-2 flex-shrink-0"></span>
                    <span>{{ bullet }}</span>
                  </li>
                {% endfor %}
              </ul>
            </div>
          {% endif %}
          {% if outline_section.content %}
            <div class="card">
              <p>{{ outline_section.content }}</p>
            </div>
          {% endif %}
        {% endif %}
      </section>
    {% endfor %}
  {% endif %}

  <!-- Call to Action Section -->
  {% if cta or outline.cta or custom_data.cta %}
    <section class="section text-center">
      <div class="card bg-brand-primary text-white">
        <h2 class="text-2xl font-bold mb-4">Ready to Get Started?</h2>
        <p class="text-lg mb-6 opacity-90">
          Take the next step towards achieving your goals.
        </p>
        <a href="#" class="btn bg-white text-brand-primary hover:bg-gray-100 px-8 py-4 text-lg">
          {{ cta or outline.cta or custom_data.cta or "Get Started" }}
        </a>
      </div>
    </section>
  {% endif %}

  <!-- Contact/Footer Section - Dynamic from brand data -->
  {% if brand.website or custom_data.contact %}
    <section class="section">
      <h2 class="section-title">Get in Touch</h2>
      <div class="card text-center">
        <p class="text-lg mb-4">
          Ready to learn more about how {{ brand.name }} can help you?
        </p>
        <div class="flex gap-4 justify-center">
          {% if brand.website %}
            <a href="{{ brand.website }}" class="btn btn-secondary">
              Visit Website
            </a>
          {% endif %}
          {% if custom_data.contact %}
            <a href="mailto:{{ custom_data.contact }}" class="btn btn-accent">
              Contact Us
            </a>
          {% endif %}
        </div>
      </div>
    </section>
  {% endif %}

  <!-- Brand Design Patterns Showcase (if available) -->
  {% if brand.ui_layout and brand.ui_layout.design_patterns %}
    <section class="section">
      <h2 class="section-title">Design Patterns</h2>
      <div class="grid grid-cols-{{ brand.ui_layout.design_patterns|length if brand.ui_layout.design_patterns|length <= 3 else 3 }} gap-6">
        {% for pattern in brand.ui_layout.design_patterns[:3] %}
          <div class="card text-center">
            <div class="text-2xl mb-2">
              {% if pattern.type == 'grid' %}üìä
              {% elif pattern.type == 'card' %}üÉè
              {% elif pattern.type == 'hero' %}üéØ
              {% elif pattern.type == 'navigation' %}üß≠
              {% else %}‚ú®{% endif %}
            </div>
            <h3 class="text-lg font-semibold text-brand-primary mb-2">{{ pattern.type|title }}</h3>
            <p class="text-sm text-brand-muted">{{ pattern.layout_type|title }} layout</p>
            {% if pattern.elements %}
              <p class="text-xs text-brand-muted mt-2">{{ pattern.elements|length }} elements</p>
            {% endif %}
          </div>
        {% endfor %}
      </div>
    </section>
  {% endif %}
{% endblock %}
